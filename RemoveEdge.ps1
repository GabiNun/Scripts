Stop-Process -Name msedge,MicrosoftEdgeUpdate -Force -ErrorAction SilentlyContinue; $u=[Security.Principal.WindowsIdentity]::GetCurrent().Name; try { Get-ChildItem C:\ -Recurse -Force -ErrorAction SilentlyContinue | Where-Object { $_.Name -like '*Edge*' -and $_.FullName -notlike 'C:\Windows\WinSxS\*' } | ForEach-Object { $p=$_.FullName; if (Test-Path $p) { if ($_.PSIsContainer) { takeown /f "$p" /r /d Y | Out-Null; icacls "$p" /grant "${u}:(F)" /t /c | Out-Null } else { takeown /f "$p" | Out-Null; icacls "$p" /grant "${u}:(F)" | Out-Null }; Remove-Item "$p" -Recurse -Force -ErrorAction SilentlyContinue } } } catch {}
